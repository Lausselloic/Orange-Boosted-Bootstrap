{{- /*
  Usage: `svg-docs file="site/static/docs/5.2/assets/brand/orange-logo" downloadable="true"`

    Prints SVG content.

    Optional parameters:
      file: SVG file path without file extension - default: `site/static/docs/5.2/assets/brand/orange-logo`
      downloadable: is the file downloadable? - default: `true`
*/ -}}

{{- $file := .Get "file" | default "site/static/docs/5.2/assets/brand/orange-logo" -}}
{{- $svgFormatted := readFile (print $file "-formatted.svg") -}}
{{- $svg := readFile (print $file ".svg") -}}
{{- $code := $svgFormatted -}}
{{- $downloadable := .Get "downloadable" | default true -}}

{{- highlight $code "html" "" }}

{{- if eq $downloadable true -}}
  {{- /* Get filename */ -}}
  {{ $output := split (print $file ".svg") "/" }}
  {{ $output  = last 1 $output }}

  {{- /* Get filesize */ -}}
  {{ $size := len $svg }}
  {{ $size  = float $size }}

  {{- /* Sort of escape-svg() */ -}}
  {{ $target := replace $svg "\"" "'" }}
  {{ $target = replace $target "#" "%23" }}
  {{ $target = replace $target "<" "%3c" }}
  {{ $target = replace $target ">" "%3e" }}
  {{ $target = replace $target "(" "%28" }}
  {{ $target = replace $target ")" "%29" }}

  <p class="text-end">
    <a class="btn btn-primary" href="data:image/svg+xml,{{ $target }}" download="{{ delimit $output "" }}">
      Download<span class="small ms-1">(SVG, {{div $size 1000}}ko)</span>
    </a>
  </p>
{{- end -}}
