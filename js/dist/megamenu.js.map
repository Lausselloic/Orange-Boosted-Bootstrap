{"version":3,"file":"megamenu.js","sources":["../src/o-megamenu.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Boosted (v4.6.2): o-megamenu.js\n * Licensed under MIT (https://github.com/Orange-OpenSource/Orange-Boosted-Bootstrap/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport $ from 'jquery'\nimport Util from './util'\n\n/* eslint no-magic-numbers: [\"error\", { \"ignore\": [-100,-1,1,2,100] }] */\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME = 'megamenu'\nconst VERSION = '4.6.2'\nconst DATA_KEY = 'bs.megamenu'\nconst JQUERY_NO_CONFLICT = $.fn[NAME]\nconst ARROW_LEFT_KEYCODE = 37 // KeyboardEvent.which value for left arrow key\nconst ARROW_RIGHT_KEYCODE = 39 // KeyboardEvent.which value for right arrow key\nconst ARROW_UP_KEYCODE = 38 // KeyboardEvent.which value for up arrow key\nconst ARROW_DOWN_KEYCODE = 40 // KeyboardEvent.which value for down arrow key\nconst TIMEOUT = 1000 // Timeout before focusing first element\nconst SPLITLENGHT = 4\nconst CLASSLENGTH = 'navbar-expand-'.length\n\nconst BreakPoints = {\n  sm: 480,\n  md: 768,\n  lg: 1024,\n  xl: 1280,\n  xxl: 1440\n}\n\nconst CLASS_NAME_TRANSITIONING = 'transitioning'\nconst CLASS_NAME_ACTIVE = 'active'\n\nconst SELECTOR_MEGAMENU = '.mega-menu'\nconst SELECTOR_PARENT = '.navbar'\nconst SELECTOR_ROOT_NAV = '.mega-menu > .navbar-nav'\nconst SELECTOR_MEGAMENU_PANEL = '.mega-menu-panel'\nconst SELECTOR_MEGAMENU_NAV = '.nav-link + .navbar-nav'\nconst SELECTOR_NAV_MENU = '.navbar-nav'\nconst SELECTOR_NAV_ITEM = '.nav-item'\nconst SELECTOR_NAV_LINK = '.nav-link'\nconst SELECTOR_NAV_LINK_COLLAPSE = '.nav-link[data-toggle=collapse]'\nconst SELECTOR_NAV_LINK_BACK = '.nav-link.back'\nconst SELECTOR_NAV_LINK_EXPANDED = '.nav-link[aria-expanded=true]'\nconst SELECTOR_CURRENT = '.nav-link[aria-current=\"page\"]'\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass MegaMenu {\n  constructor(element, config) {\n    this._element = element\n    this._parent = $(this._element).parents(SELECTOR_PARENT)\n    this._$parentNavbarClasses = this._parent.attr('class')\n    // default if no class navbar-expand-* navbar is always mobile\n    this._$mediaQuery = window.matchMedia('(min-width: 0px)')\n    this._$isRTL = document.dir === 'rtl' ? -1 : 1\n    if (typeof this._$parentNavbarClasses !== 'undefined' && this._$parentNavbarClasses.indexOf('navbar-expand-') !== -1) {\n      if (this._parent.hasClass('navbar-expand-xxl')) {\n        this._$breakpoint = 'xxl'\n      } else {\n        this._$breakpointIndex = this._$parentNavbarClasses.indexOf('navbar-expand-') + CLASSLENGTH\n        this._$breakpoint = this._$parentNavbarClasses.slice(this._$breakpointIndex, this._$breakpointIndex + 2)\n      }\n\n      this._$mediaQuery = window.matchMedia(`(max-width: ${BreakPoints[this._$breakpoint]}px)`)\n    }\n\n    this._$navLinks = $(this._element).find(SELECTOR_NAV_LINK)\n    this._$goForwardLinks = $(this._element).find(SELECTOR_MEGAMENU_NAV).prev(SELECTOR_NAV_LINK)\n    this._$goBackLinks = $(this._element).find(SELECTOR_NAV_LINK_BACK)\n    this._$topCollapseMenus = $(this._element).find(SELECTOR_MEGAMENU_PANEL)\n    this._$navLinkCollapses = $(this._element).find(SELECTOR_NAV_LINK_COLLAPSE)\n    this._config = config\n    if (typeof this._config.noFocus === 'undefined') {\n      this._config.noFocus = false\n    }\n\n    this._addEventListeners()\n    if (this._$mediaQuery.matches) {\n      this._addAriaAttributes(this._element)\n    }\n\n    this.goTo = this._initPosition\n\n    window.addEventListener('resize', () => {\n      if (this._$mediaQuery.matches) {\n        this._addAriaAttributes(this._element)\n      } else {\n        this._removeAriaAttributes(this._element)\n        $(this._element).find(SELECTOR_NAV_MENU).first().attr('style', null)\n        $(this._element).find(SELECTOR_NAV_MENU).show()\n        $(this._element).height('auto')\n      }\n    })\n  }\n\n  // getters\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  // public\n\n  // private\n\n  _addEventListeners() {\n    this._$goForwardLinks.on('click', event => this._goForward(event))\n    this._$goBackLinks.on('click', event => this._goBackward(event))\n    this._$navLinks.on('keydown', event => this._manageKeyDown(event))\n    if (!this._config.noFocus) {\n      this._$topCollapseMenus.on('shown.bs.collapse', this._collapseFocus)\n    }\n\n    $(this._element).on('hidden.bs.collapse', event => this._handleCollapseToggle(event))\n    this._$navLinkCollapses.on('click', event => this._handleCollapseToggle(event))\n  }\n\n  _addAriaAttributes(element) {\n    const $subNavs = $(element).find(SELECTOR_MEGAMENU_NAV)\n    const $parents = $(element).find(SELECTOR_CURRENT).parents(SELECTOR_NAV_ITEM)\n\n    $(element).attr('role', 'application')\n    $(element).find('> .navbar-nav').attr('role', 'menu')\n    $(element).find(SELECTOR_MEGAMENU_PANEL).attr('role', 'menu')\n    $(element).find('.nav-link[data-toggle=collapse]').attr('role', 'menuitem')\n    $(element).find(SELECTOR_NAV_LINK_BACK).attr('aria-hidden', 'true')\n    $(element).find(SELECTOR_NAV_ITEM).attr('role', 'presentation')\n\n    $parents.each(function () {\n      $(this).find(SELECTOR_NAV_LINK).first().attr('aria-current', 'true')\n    })\n\n    $subNavs.each(function () {\n      const navId = Util.getUID(NAME)\n      const $thisNavToggler = $(this).prev(SELECTOR_NAV_LINK)\n      const $thisNav = $(this)\n      const $thisNavBackLink = $thisNav.find(SELECTOR_NAV_LINK_BACK)\n\n      $thisNav.attr({\n        id: navId,\n        role: 'menu'\n      })\n      $thisNavToggler.attr({\n        role: 'menuitem',\n        'aria-controls': navId,\n        'aria-expanded': false,\n        'aria-haspopup': true\n      })\n      $thisNavBackLink.attr({\n        role: 'menuitem',\n        'aria-controls': navId\n      })\n    })\n  }\n\n  _removeAriaAttributes(element) {\n    const $subNavs = $(element).find(SELECTOR_MEGAMENU_NAV)\n\n    $(element).attr('role', null)\n    $(element).find('> .navbar-nav').attr('role', null)\n    $(element).find(SELECTOR_MEGAMENU_PANEL).attr('role', null)\n    $(element).find('.nav-link[data-toggle=collapse]').attr('role', null)\n    $(element).find(SELECTOR_NAV_LINK).attr({\n      'aria-hidden': null,\n      tabindex: null\n    })\n    $(element).find(SELECTOR_NAV_ITEM).attr('role', null)\n    $(element).find(SELECTOR_NAV_MENU).attr('style', null)\n\n    $subNavs.each(function () {\n      const $thisNavToggler = $(this).prev(SELECTOR_NAV_LINK)\n      const $thisNav = $(this)\n      const $thisNavBackLink = $thisNav.find(SELECTOR_NAV_LINK_BACK)\n\n      $thisNav.attr('role', null)\n      $thisNavToggler.attr({\n        role: null,\n        'aria-controls': null,\n        'aria-expanded': null,\n        'aria-haspopup': null\n      })\n      $thisNavBackLink.attr({\n        role: null,\n        'aria-controls': null\n      })\n    })\n  }\n\n  _initPosition(target) {\n    if (!$(target).length) {\n      return\n    }\n\n    const $target = $(target).first()\n    const position = $target.parents().index(this._element)\n    const rootPosition = $('.mega-menu-panel .nav-link').first().parents().index($('.mega-menu'))\n    // @TODO WTF RTL?\n    const translatePercentage = -(position - rootPosition) * 100 / 2\n    const $thisNav = $target.closest(SELECTOR_NAV_MENU)\n    const $rootNav = $target.closest(SELECTOR_ROOT_NAV)\n\n    $rootNav.addClass(CLASS_NAME_TRANSITIONING)\n    this._$navLinkCollapses.removeClass(CLASS_NAME_ACTIVE)\n\n    // open collapse\n    if ($target.attr('data-toggle') === 'collapse') {\n      $target.siblings(SELECTOR_MEGAMENU_PANEL).collapse('show')\n      $target.addClass(CLASS_NAME_ACTIVE)\n      this._$topCollapseMenus.not($target.siblings(SELECTOR_MEGAMENU_PANEL)).collapse('hide')\n      $(this._element).height('auto')\n      $rootNav.css('transform', 'translateX(0%)')\n    } else {\n      $target.closest(SELECTOR_MEGAMENU_PANEL).collapse('show')\n      $target.closest(SELECTOR_NAV_LINK_COLLAPSE).addClass(CLASS_NAME_ACTIVE)\n      this._$topCollapseMenus.not($target.closest(SELECTOR_MEGAMENU_PANEL)).collapse('hide')\n\n      if (this._$mediaQuery.matches) {\n        // show menu and hide other\n        $target.parents(SELECTOR_NAV_MENU).show()\n\n        // set aria on parent links\n        $target.parents(SELECTOR_NAV_ITEM).find('> .nav-link').not($target).attr({\n          tabindex: -1,\n          'aria-hidden': true,\n          'aria-expanded': true\n        })\n\n        // translate to pos\n        $rootNav.css('transform', `translateX(${translatePercentage * this._$isRTL}%)`)\n        if (translatePercentage) {\n          // adapt main collapse height to target height\n          $(this._element).height($thisNav.height())\n        } else {\n          $(this._element).height('auto')\n        }\n      }\n    }\n\n    // set focus on target link\n    setTimeout(() => {\n      if (!this._config.noFocus) {\n        // set focus on target link\n        $target.trigger('focus')\n      }\n\n      $rootNav.removeClass(CLASS_NAME_TRANSITIONING)\n    }, TIMEOUT)\n  }\n\n  _manageKeyDown(event) {\n    const $thisTarget = $(event.target)\n\n    // test key code\n    if (/input|textarea/i.test(event.target.tagName)) {\n      return\n    }\n\n    // proceed according to key code\n    switch (event.which) {\n      case ARROW_LEFT_KEYCODE:\n        this._goBackward(event)\n        break\n      case ARROW_RIGHT_KEYCODE:\n        this._goForward(event)\n        break\n      case ARROW_UP_KEYCODE:\n        // focus prev nav link\n        $thisTarget.parent().prev().find('>.nav-link').not(SELECTOR_NAV_LINK_BACK).trigger('focus')\n        break\n      case ARROW_DOWN_KEYCODE:\n        // focus next nav link\n        $thisTarget.parent().next().find('>.nav-link').trigger('focus')\n        break\n      default:\n    }\n  }\n\n  _collapseFocus() {\n    $(this).find(SELECTOR_NAV_LINK).not(SELECTOR_NAV_LINK_BACK).first().trigger('focus')\n  }\n\n  _handleCollapseToggle(event) {\n    const $this = $(event.target)\n    const $thisCollapse = $($this.attr('href'))\n\n    if ($this.is($(this._element))) {\n      $this.children(SELECTOR_NAV_MENU).css('transform', 'translateX(0%)')\n      $this.height('auto')\n      $this.find(SELECTOR_NAV_LINK_EXPANDED).attr({\n        'aria-expanded': false,\n        'aria-hidden': null,\n        tabindex: null\n      })\n      $this.find(SELECTOR_NAV_LINK_EXPANDED).next(SELECTOR_NAV_MENU).hide()\n    } else {\n      $this.toggleClass(CLASS_NAME_ACTIVE)\n    }\n\n    this._$navLinkCollapses.not($this).removeClass(CLASS_NAME_ACTIVE)\n    this._$topCollapseMenus.not($thisCollapse).removeClass(CLASS_NAME_ACTIVE).collapse('hide')\n  }\n\n  _goForward(event) {\n    if (!this._$mediaQuery.matches) {\n      return false\n    }\n\n    event.preventDefault()\n    const $this = $(event.target)\n    const $thisNav = $this.closest(SELECTOR_NAV_MENU)\n    const $targetNav = $this.next(SELECTOR_NAV_MENU)\n    const $rootNav = $this.closest(SELECTOR_ROOT_NAV)\n    const $thisNavToggler = $this\n    const currentTranslatePos = parseInt($rootNav.css('transform').split(',')[SPLITLENGHT], 10)\n    const navWidth = $rootNav.width()\n    // @TODO WTF RTL?\n    const currentTranslatePercentage = 100 * currentTranslatePos / navWidth\n\n    if (!$this.next(SELECTOR_NAV_MENU).length || $rootNav.hasClass(CLASS_NAME_TRANSITIONING)) {\n      return false\n    }\n\n    $rootNav.addClass(CLASS_NAME_TRANSITIONING)\n\n    // hide all nav on same level\n    $thisNav.find(SELECTOR_NAV_MENU).hide()\n\n    // show target navbar-nav\n    $targetNav.show()\n\n    // adapt main collapse height to target height\n    $(SELECTOR_MEGAMENU).height($targetNav.height())\n\n    // make only visible elements focusable\n    if (!currentTranslatePercentage) {\n      $rootNav.find('>.nav-item .nav-link').attr({\n        tabindex: -1,\n        'aria-hidden': true\n      })\n    }\n\n    $thisNav.find(SELECTOR_NAV_LINK).attr({\n      tabindex: -1,\n      'aria-hidden': true\n    })\n    $targetNav.find(SELECTOR_NAV_LINK).attr({\n      tabindex: 0,\n      'aria-hidden': false\n    })\n\n    // translate menu\n    // @TODO WTF RTL?\n    $rootNav.css('transform', `translateX(${currentTranslatePercentage - 100 * this._$isRTL}%)`)\n\n    // focus on target nav first item\n    $rootNav.one('transitionend', () => {\n      $thisNavToggler.attr('aria-expanded', true)\n      $targetNav.find(SELECTOR_NAV_LINK).not(SELECTOR_NAV_LINK_BACK).first().trigger('focus')\n      $rootNav.removeClass(CLASS_NAME_TRANSITIONING)\n    })\n    return true\n  }\n\n  _goBackward(event) {\n    if (!this._$mediaQuery.matches) {\n      return false\n    }\n\n    event.preventDefault()\n\n    const $this = $(event.target)\n    const $thisNav = $this.closest(SELECTOR_NAV_MENU)\n    const $targetNav = $thisNav.parent().closest(SELECTOR_NAV_MENU)\n    const $rootNav = $this.closest(SELECTOR_ROOT_NAV)\n    const $targetNavToggler = $targetNav.find(SELECTOR_NAV_LINK_EXPANDED)\n    const currentTranslatePos = parseInt($rootNav.css('transform').split(',')[SPLITLENGHT], 10)\n    const navWidth = $rootNav.width()\n    // @TODO WTF RTL?\n    const currentTranslatePercentage = 100 * currentTranslatePos / navWidth\n\n    if (!currentTranslatePercentage || $rootNav.hasClass(CLASS_NAME_TRANSITIONING)) {\n      return false\n    }\n\n    $rootNav.addClass(CLASS_NAME_TRANSITIONING)\n    // reset main collapse height\n    $(SELECTOR_MEGAMENU).height('auto')\n\n    // make only visible elements focusable\n    $targetNav.find(SELECTOR_NAV_LINK).attr({\n      tabindex: 0,\n      'aria-hidden': false\n    })\n    // @TODO WTF RTL?\n    if (currentTranslatePercentage === -100) {\n      $rootNav.find('>.nav-item .nav-link').attr({\n        tabindex: 0,\n        'aria-hidden': false\n      })\n    }\n\n    // translate menu\n    // @TODO WTF RTL?\n    $rootNav.css('transform', `translateX(${currentTranslatePercentage + 100 * this._$isRTL}%)`)\n\n    // focus on target nav first item\n    $rootNav.one('transitionend', () => {\n      $targetNavToggler.attr('aria-expanded', false)\n      $targetNavToggler.trigger('focus')\n      $thisNav.hide()\n      $rootNav.removeClass(CLASS_NAME_TRANSITIONING)\n    })\n    return true\n  }\n\n  // static\n\n  static _jQueryInterface(config) {\n    return this.each(function () {\n      if (!$(this).is(SELECTOR_MEGAMENU)) {\n        throw new TypeError('Element is not a mega menu')\n      }\n\n      if (!config) {\n        config = {}\n      } else if (config.noFocus && typeof config.noFocus !== 'boolean') {\n        // param = true\n        throw new TypeError('no-focus parameter must be boolean')\n      }\n\n      let data = $(this).data(DATA_KEY)\n\n      if (!data) {\n        data = new MegaMenu(this, config)\n        $(this).data(DATA_KEY, data)\n      }\n\n      if (config.target) {\n        if (typeof config.target !== 'string' || !/^[#.].*/.test(config.target)) {\n          throw new TypeError(`Selector \"${config.target}\" is not supported`)\n        }\n\n        data.goTo(config.target)\n      }\n    })\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n\n$.fn[NAME] = MegaMenu._jQueryInterface\n$.fn[NAME].Constructor = MegaMenu\n$.fn[NAME].noConflict = () => {\n  $.fn[NAME] = JQUERY_NO_CONFLICT\n  return MegaMenu._jQueryInterface\n}\n\nexport default MegaMenu\n"],"names":["NAME","VERSION","DATA_KEY","JQUERY_NO_CONFLICT","$","fn","ARROW_LEFT_KEYCODE","ARROW_RIGHT_KEYCODE","ARROW_UP_KEYCODE","ARROW_DOWN_KEYCODE","TIMEOUT","SPLITLENGHT","CLASSLENGTH","length","BreakPoints","sm","md","lg","xl","xxl","CLASS_NAME_TRANSITIONING","CLASS_NAME_ACTIVE","SELECTOR_MEGAMENU","SELECTOR_PARENT","SELECTOR_ROOT_NAV","SELECTOR_MEGAMENU_PANEL","SELECTOR_MEGAMENU_NAV","SELECTOR_NAV_MENU","SELECTOR_NAV_ITEM","SELECTOR_NAV_LINK","SELECTOR_NAV_LINK_COLLAPSE","SELECTOR_NAV_LINK_BACK","SELECTOR_NAV_LINK_EXPANDED","SELECTOR_CURRENT","MegaMenu","element","config","_element","_parent","parents","_$parentNavbarClasses","attr","_$mediaQuery","window","matchMedia","_$isRTL","document","dir","indexOf","hasClass","_$breakpoint","_$breakpointIndex","slice","_$navLinks","find","_$goForwardLinks","prev","_$goBackLinks","_$topCollapseMenus","_$navLinkCollapses","_config","noFocus","_addEventListeners","matches","_addAriaAttributes","goTo","_initPosition","addEventListener","_removeAriaAttributes","first","show","height","on","event","_goForward","_goBackward","_manageKeyDown","_collapseFocus","_handleCollapseToggle","$subNavs","$parents","each","navId","Util","getUID","$thisNavToggler","$thisNav","$thisNavBackLink","id","role","tabindex","target","$target","position","index","rootPosition","translatePercentage","closest","$rootNav","addClass","removeClass","siblings","collapse","not","css","setTimeout","trigger","$thisTarget","test","tagName","which","parent","next","$this","$thisCollapse","is","children","hide","toggleClass","preventDefault","$targetNav","currentTranslatePos","parseInt","split","navWidth","width","currentTranslatePercentage","one","$targetNavToggler","_jQueryInterface","TypeError","data","Constructor","noConflict"],"mappings":"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"}