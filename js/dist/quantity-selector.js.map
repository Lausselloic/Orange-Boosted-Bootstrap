{"version":3,"file":"quantity-selector.js","sources":["../src/quantity-selector.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Boosted (v5.2.1): quantity-selector.js\n * Licensed under MIT (https://github.com/Orange-OpenSource/Orange-Boosted-Bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport { defineJQueryPlugin } from './util/index'\nimport EventHandler from './dom/event-handler'\nimport BaseComponent from './base-component'\nimport SelectorEngine from './dom/selector-engine'\n\n/**\n * Constants\n */\n\nconst NAME = 'quantityselector'\nconst DATA_KEY = 'bs.quantityselector'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}${DATA_API_KEY}`\nconst EVENT_CHANGE_DATA_API = `change${EVENT_KEY}${DATA_API_KEY}`\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\n\nconst SELECTOR_STEP_UP_BUTTON = '[data-bs-step=\"up\"]'\nconst SELECTOR_STEP_DOWN_BUTTON = '[data-bs-step=\"down\"]'\nconst SELECTOR_COUNTER_INPUT = '[data-bs-step=\"counter\"]'\nconst SELECTOR_INPUT_GROUP = '.input-group'\n\n/**\n * Class definition\n */\n\nclass QuantitySelector extends BaseComponent {\n  // Getters\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  ValueOnLoad(element) {\n    const counterInput = element.querySelector(SELECTOR_COUNTER_INPUT)\n    const btnUp = element.querySelector(SELECTOR_STEP_UP_BUTTON)\n    const btnDown = element.querySelector(SELECTOR_STEP_DOWN_BUTTON)\n\n    const min = counterInput.getAttribute('min')\n    const max = counterInput.getAttribute('max')\n    const step = Number(counterInput.getAttribute('step'))\n\n    if (Number(counterInput.value) - step < min) {\n      btnDown.setAttribute('disabled', '')\n    }\n\n    if (Number(counterInput.value) + step > max) {\n      btnUp.setAttribute('disabled', '')\n    }\n  }\n\n  // Static\n  static StepUp(event) {\n    const parent = event.target.closest(SELECTOR_INPUT_GROUP)\n    const counterInput = parent.querySelector(SELECTOR_COUNTER_INPUT)\n\n    const max = counterInput.getAttribute('max')\n    const step = Number(counterInput.getAttribute('step'))\n    const round = Number(counterInput.getAttribute('data-bs-round'))\n\n    const eventChange = new Event('change')\n\n    if (Number(counterInput.value) < max) {\n      counterInput.value = (Number(counterInput.value) + step).toFixed(round).toString()\n    }\n\n    counterInput.dispatchEvent(eventChange)\n  }\n\n  static StepDown(event) {\n    const parent = event.target.closest(SELECTOR_INPUT_GROUP)\n    const counterInput = parent.querySelector(SELECTOR_COUNTER_INPUT)\n\n    const min = counterInput.getAttribute('min')\n    const step = Number(counterInput.getAttribute('step'))\n    const round = Number(counterInput.getAttribute('data-bs-round'))\n\n    const eventChange = new Event('change')\n\n    if (Number(counterInput.value) > min) {\n      counterInput.value = (Number(counterInput.value) - step).toFixed(round).toString()\n    }\n\n    counterInput.dispatchEvent(eventChange)\n  }\n\n  static CheckIfDisabledOnChange(event) {\n    const parent = event.target.closest(SELECTOR_INPUT_GROUP)\n    const counterInput = parent.querySelector(SELECTOR_COUNTER_INPUT)\n    const btnUp = parent.querySelector(SELECTOR_STEP_UP_BUTTON)\n    const btnDown = parent.querySelector(SELECTOR_STEP_DOWN_BUTTON)\n\n    const min = counterInput.getAttribute('min')\n    const max = counterInput.getAttribute('max')\n    const step = Number(counterInput.getAttribute('step'))\n\n    btnUp.removeAttribute('disabled', '')\n    btnDown.removeAttribute('disabled', '')\n\n    if (Number(counterInput.value) - step < min) {\n      btnDown.setAttribute('disabled', '')\n    }\n\n    if (Number(counterInput.value) + step > max) {\n      btnUp.setAttribute('disabled', '')\n    }\n  }\n\n  static jQueryInterface(config) {\n    return this.each(function () {\n      const data = QuantitySelector.getOrCreateInstance(this, config)\n\n      if (typeof config !== 'string') {\n        return\n      }\n\n      if (typeof data[config] === 'undefined') {\n        throw new TypeError(`No method named \"${config}\"`)\n      }\n\n      data[config]()\n    })\n  }\n}\n\n/**\n * Data API implementation\n */\n\nEventHandler.on(document, EVENT_CHANGE_DATA_API, SELECTOR_COUNTER_INPUT, QuantitySelector.CheckIfDisabledOnChange)\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_STEP_UP_BUTTON, QuantitySelector.StepUp)\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_STEP_DOWN_BUTTON, QuantitySelector.StepDown)\n\nEventHandler.on(window, EVENT_LOAD_DATA_API, () => {\n  for (const el of SelectorEngine.find(SELECTOR_INPUT_GROUP)) {\n    QuantitySelector.getOrCreateInstance(el).ValueOnLoad(el)\n  }\n})\n\n/**\n * jQuery\n */\n\ndefineJQueryPlugin(QuantitySelector)\n\nexport default QuantitySelector\n"],"names":["NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","EVENT_LOAD_DATA_API","EVENT_CHANGE_DATA_API","EVENT_CLICK_DATA_API","SELECTOR_STEP_UP_BUTTON","SELECTOR_STEP_DOWN_BUTTON","SELECTOR_COUNTER_INPUT","SELECTOR_INPUT_GROUP","QuantitySelector","BaseComponent","ValueOnLoad","element","counterInput","querySelector","btnUp","btnDown","min","getAttribute","max","step","Number","value","setAttribute","StepUp","event","parent","target","closest","round","eventChange","Event","toFixed","toString","dispatchEvent","StepDown","CheckIfDisabledOnChange","removeAttribute","jQueryInterface","config","each","data","getOrCreateInstance","TypeError","EventHandler","on","document","window","el","SelectorEngine","find","defineJQueryPlugin"],"mappings":"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"}