{"version":3,"file":"prioritynav.js","sources":["../src/o-priority-nav.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Boosted (v4.6.2): o-priority-nav.js\n * Licensed under MIT (https://github.com/Orange-OpenSource/Orange-Boosted-Bootstrap/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport $ from 'jquery'\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME = 'prioritynav'\nconst VERSION = '4.6.2'\nconst DATA_KEY = 'bs.prioritynav'\nconst JQUERY_NO_CONFLICT = $.fn[NAME]\nconst RESIZE_DURATION = 500\nconst TAB_KEYCODE = 9\n\nconst EVENT_RESIZE = 'resize'\n\nconst CLASS_NAME_HIDE = 'sr-only'\nconst CLASS_NAME_RESIZING = 'resizing overflow-hidden'\n\nconst SELECTOR_NAV_ELEMENTS = 'li:not(\\'.overflow-nav\\')'\nconst SELECTOR_FIRST_ELEMENT = 'li:first'\n\nconst MenuLabelDefault = 'More'\n\nfunction menuTemplate(MenuLabel) {\n  return `\n  <li class=\"overflow-nav nav-item dropdown d-none\">\n      <a href=\"#\" class=\"dropdown-toggle nav-link\" data-toggle=\"dropdown\" role=\"button\">${MenuLabel}</a>\n      <ul class=\"overflow-nav-list dropdown-menu dropdown-menu-right\"></ul>\n  </li>\n`\n}\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass PriorityNav {\n  constructor(element, config) {\n    this._element = element\n    this._config = config\n    this._$menu = $(element).is('ul') ? $(element) : $(element).find('ul').first()\n    this._initMenu()\n    this._$allNavElements = this._$menu.find(SELECTOR_NAV_ELEMENTS)\n    this._bindUIActions()\n    this._setupMenu()\n  }\n\n  // getters\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  // public\n\n  // private\n\n  _initMenu() {\n    let MenuLabel = this._config\n\n    if (typeof MenuLabel === 'undefined') {\n      MenuLabel = MenuLabelDefault\n    }\n\n    // add menu template\n    this._$menu.append(menuTemplate(MenuLabel))\n  }\n\n  _setupMenu() {\n    const $allNavElements = this._$allNavElements\n\n    // Checking top position of first item (sometimes changes)\n    const firstPos = this._$menu.find(SELECTOR_FIRST_ELEMENT).position()\n\n    // Empty collection in which to put menu items to move\n    let $wrappedElements = $()\n\n    // Used to snag the previous menu item in addition to ones that have wrapped\n    let first = true\n\n    // Loop through all the nav items...\n    this._$allNavElements.each(function (i) {\n      const $elm = $(this)\n\n      // ...in which to find wrapped elements\n      const pos = $elm.position()\n\n      if (pos.top !== firstPos.top) {\n        // If element is wrapped, add it to set\n        $wrappedElements = $wrappedElements.add($elm)\n\n        // Add the previous one too, if first\n        if (first) {\n          $wrappedElements = $wrappedElements.add($allNavElements.eq(i - 1))\n          first = false\n        }\n      }\n    })\n\n    if ($wrappedElements.length) {\n      // Clone set before altering\n      const newSet = $wrappedElements.clone()\n\n      // Hide ones that we're moving\n      $wrappedElements.addClass(CLASS_NAME_HIDE)\n      $wrappedElements.find('.nav-link').attr('tabindex', -1)\n\n      // Add wrapped elements to dropdown\n      this._$menu.find('.overflow-nav-list').append(newSet)\n\n      // Show new menu\n      this._$menu.find('.overflow-nav').removeClass('d-none').addClass('d-inline-block')\n\n      // Make overflow visible again so dropdown can be seen.\n      this._$menu.find('.o-nav-local').css('overflow', 'visible')\n\n      // Check if menu doesn't overflow after process\n      if (this._$menu.find('.overflow-nav').position().top !== firstPos.top) {\n        const $item = $(this._element).find(`.${CLASS_NAME_HIDE}`).first().prev()\n        const $itemDuplicate = $item.clone()\n\n        $item.addClass(CLASS_NAME_HIDE)\n        $item.find('.nav-link').attr('tabindex', -1)\n\n        this._$menu.find('.overflow-nav-list').prepend($itemDuplicate)\n      }\n    }\n\n    // hide menu from AT\n    this._$menu.find('.overflow-nav').attr('aria-hidden', true)\n  }\n\n  _tearDown() {\n    this._$menu.find('.overflow-nav-list').empty()\n    this._$menu.find('.overflow-nav').removeClass('d-inline-block').addClass('d-none')\n    this._$allNavElements.removeClass(CLASS_NAME_HIDE)\n    this._$allNavElements.find('.nav-link').attr('tabindex', 0)\n  }\n\n  _bindUIActions() {\n    $(window).on(EVENT_RESIZE, () => {\n      this._$menu.addClass(CLASS_NAME_RESIZING)\n\n      setTimeout(() => {\n        this._tearDown()\n        this._setupMenu()\n        this._$menu.removeClass(CLASS_NAME_RESIZING)\n      }, RESIZE_DURATION)\n    })\n\n    this._$menu.find('.overflow-nav .dropdown-toggle').on('keyup', e => {\n      if (e.which === TAB_KEYCODE) {\n        $(e.target).dropdown('toggle')\n      }\n    })\n  }\n\n  // static\n\n  static _jQueryInterface(config) {\n    return this.each(function () {\n      let data = $(this).data(DATA_KEY)\n\n      if (!data) {\n        data = new PriorityNav(this, config)\n        $(this).data(DATA_KEY, data)\n      }\n\n      if ((typeof config !== 'undefined' && config) && typeof config !== 'string') {\n        throw new TypeError('Priority nav label type must be string')\n      }\n    })\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n\n$.fn[NAME] = PriorityNav._jQueryInterface\n$.fn[NAME].Constructor = PriorityNav\n$.fn[NAME].noConflict = () => {\n  $.fn[NAME] = JQUERY_NO_CONFLICT\n  return PriorityNav._jQueryInterface\n}\n\nexport default PriorityNav\n"],"names":["NAME","VERSION","DATA_KEY","JQUERY_NO_CONFLICT","$","fn","RESIZE_DURATION","TAB_KEYCODE","EVENT_RESIZE","CLASS_NAME_HIDE","CLASS_NAME_RESIZING","SELECTOR_NAV_ELEMENTS","SELECTOR_FIRST_ELEMENT","MenuLabelDefault","menuTemplate","MenuLabel","PriorityNav","element","config","_element","_config","_$menu","is","find","first","_initMenu","_$allNavElements","_bindUIActions","_setupMenu","append","$allNavElements","firstPos","position","$wrappedElements","each","i","$elm","pos","top","add","eq","length","newSet","clone","addClass","attr","removeClass","css","$item","prev","$itemDuplicate","prepend","_tearDown","empty","window","on","setTimeout","e","which","target","dropdown","_jQueryInterface","data","TypeError","Constructor","noConflict"],"mappings":"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"}